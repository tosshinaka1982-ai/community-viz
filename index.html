<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>AI Analysis POC</title>
    <style>
      body { font-family: system-ui; padding: 16px; background: #fafafa; }
      textarea { width: 100%; min-height: 120px; margin-top: 8px; }
      pre { background: #fff; padding: 12px; border-radius: 8px; white-space: pre-wrap; }
      button { margin-top: 8px; padding: 8px 12px; }
    </style>
  </head>
  <body>
    <h2>AI Analysis (POC)</h2>
    <p>â†“ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰å‚¾å‘ãªã©ã‚’å…¥åŠ›ã—ã¦AIåˆ†æã§ãã¾ã™ã€‚</p>

    <textarea id="prompt" placeholder="ä¾‹ï¼šãã‚ˆé¢¨ã®æ‚£è€…å¢—åŠ å‚¾å‘ã‚’åˆ†æã—ã¦"></textarea>
    <button id="run">AIåˆ†æ</button>

    <h3>çµæœ</h3>
    <pre id="output">ï¼ˆã“ã“ã«çµæœãŒå‡ºã¾ã™ï¼‰</pre>

    <!-- ğŸ”¹ seed data -->
<script type="application/json" id="seed-data">
{
  "schema": ["æ‹ ç‚¹å","25/04","25/05","25/06","25/07","25/08","25/09","25/10","25/11","ç·è¨ˆ"],
  "rows": [
    ["ã‚ã’ãŠ", null,  null,  35, 24, 22, 10, 12, null, 103],
    ["ãã‚ˆé¢¨", 25,    44,    57, 75, 77, 73, 34, 1,   386],
    ["ãã‚ˆé¢¨ãƒ»ç™½çŸ³",29,    23,    25, 30, 67, 13, 18, null,205],
    ["ãƒ—ãƒªãƒ ", null,  null,  null,null,19, 13, 18, 10, 60],
    ["ä¼Šå‹¢å´",34,    25,    44, 24, 31, 28, 22, null,208],
    ["å‰ç”°",  45,    38,    43, 34, 44, 46, 23, 1,   274],
    ["å‰ç”°åè¥¿",null,null,  null,null,null,19, 22, 14, 55],
    ["å›½åˆ†å¯º",10,    11,    6,  6,  6,  9,  4,  null,52],
    ["å º",    12,    12,    10, 11, 10, 8,  6,  null,69],
    ["æœ­å¹Œ",  null,  null,  null,null,null,null,8,  null,8],
    ["å¸‚åŸ",  20,    64,    18, 15, 7,  25, 7,  null,156],
    ["å¸‚å·",  14,    24,    15, 19, 14, 15, 4,  4,   109],
    ["å®ˆè°·",  19,    12,    23, 22, 14, 5,  null,null,95],
    ["é’é‡",  17,    13,    34, 19, 7,  14, 3,  null,107],
    ["æ‘‚æ´¥",  2,     5,     4,  5,  3,  6,  5,  null,30],
    ["ä»™å°",  5,     5,     21, 19, 32, 38, 25, null,145],
    ["å‰æ©‹",  35,    21,    28, 29, 22, 33, 19, null,187],
    ["è˜‡æˆ‘",  37,    30,    35, 28, 2,  null,null,null,132],
    ["ç”ºç”°",  27,    25,    16, 17, 15, 28, 13, null,141],
    ["å¤©ç‹ç”º",50,    22,    28, 36, 48, 21, null,null,205],
    ["å—å¢—å°¾",null,  null,  null,null,16, 7,  null,null,23],
    ["æ—¥ç«‹",  4,     15,    8,  12, 10, 12, 9,  null,70],
    ["å…«æ½®",  null,  null,  null,null,23, 19, 21, 18, 81],
    ["åºœä¸­",  5,     6,     11, 12, 7,  12, null,null,53],
    ["è±Šæ©‹",  13,    7,     10, 10, 14, 13, 3,  null,70]
  ]
}
</script>


    <script>
      const API_KEY = "AIzaSyB1Qf-xLUvF6NZpGXl9r4EHEhNyKrvdXTk";
      const MODEL = "gemini-2.5-pro";

      async function callGemini(prompt, data) {
        const url = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`;
        const body = {
          contents: [{
            role: "user",
            parts: [{
              text: `æ¬¡ã®ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã¦ï¼š\n${JSON.stringify(data)}\n\nè³ªå•:${prompt}`
            }]
          }]
        };
        const res = await fetch(url, {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify(body)
        });
        if (!res.ok) {
          const err = await res.text();
          throw new Error(err);
        }
        const json = await res.json();
        return json?.candidates?.[0]?.content?.parts?.[0]?.text ?? "(å¿œç­”ãªã—)";
      }

      document.getElementById("run").addEventListener("click", async () => {
        const prompt = document.getElementById("prompt").value.trim();
        const seedData = JSON.parse(document.getElementById("seed-data").textContent);
        const out = document.getElementById("output");
        if (!prompt) return out.textContent = "è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";

        out.textContent = "åˆ†æä¸­...";
        try {
          const result = await callGemini(prompt, seedData);
          out.textContent = result;
        } catch (err) {
          out.textContent = "ã‚¨ãƒ©ãƒ¼: " + err.message;
        }
      });
    </script>
  </body>
</html>
